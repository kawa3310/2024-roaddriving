import{a as u}from"./axios-G2rPRu76.js";import{S as a}from"./sweetalert2.esm.all-HDkAWA8Y.js";/* empty css              */import{L as w}from"./index-G0JYQuIa.js";import{P as y}from"./PaginationModal-JdJL41KI.js";import{_ as C,c as l,b as f,a as t,F as m,v as b,d as x,r as g,o as n,u as d,x as k,D as O}from"./index-9b0SxjyI.js";var $={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"rei",BASE_URL:"/2024-roaddriving/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:p,VITE_PATH:h}=$,P={data(){return{orderData:{},pagination:{},pages:{},isloading:!1,isNew:!1}},methods:{getOrders(i=1){this.isloading=!0,u.get(`${p}/api/${h}/admin/orders?page=${i}`).then(s=>{this.orderData=s.data.orders,this.pages=s.data.pagination,this.isloading=!1}).catch(s=>{this.isloading=!1,a.fire({toast:!0,position:"center",showConfirmButton:!1,timer:1500,icon:"error",title:s.response.data.message})})},addOrderStates(i){this.isloading=!0;const s={is_paid:i.is_paid};u.put(`${p}/api/${h}/admin/order/${i.id}`,{data:s}).then(()=>{this.isNew=!1,this.isloading=!1,this.$refs.orderModal.modalClose(),this.getOrders(),a.fire({toast:!0,position:"center",showConfirmButton:!1,timer:1500,icon:"success",title:"編輯成功"})}).catch(()=>{this.isloading=!1,a.fire({toast:!0,position:"center",showConfirmButton:!1,timer:1500,icon:"error",title:"編輯失敗"})})},delOrder(i){this.isNew=!0,this.isloading=!0,u.delete(`${p}/api/${h}/admin/order/${i.id}`).then(()=>{this.isNew=!1,this.isloading=!1,this.getOrders(),a.fire({toast:!0,position:"center",showConfirmButton:!1,timer:1500,icon:"success",title:"刪除成功"})}).catch(s=>{this.isloading=!1,a.fire({toast:!0,position:"center",showConfirmButton:!1,timer:1500,icon:"error",title:s.response.data.message})})}},mounted(){this.getOrders()},components:{PaginationModal:y,Loading:w}},V={class:"container px-6"},E={class:"admin-table"},M={class:"table mt-4 table-bordered"},S={class:"form-check form-switch"},B=["onUpdate:modelValue","id","onChange"],D=["for"],L={class:"btn-group"},N=["onClick"],T={class:"modal fade",id:"orderModal",tabindex:"-1","aria-labelledby":"orderModal","aria-hidden":"true"},U={class:"modal-dialog modal-xl"},I={class:"modal-content border-0"},R={class:"modal-body"},A={class:"row"},F={class:"col-3"},H={class:"mb-3"};function z(i,s,j,q,r,c){const _=g("Loading"),v=g("PaginationModal");return n(),l(m,null,[f(_,{active:r.isloading,"z-index":1060},null,8,["active"]),t("div",V,[s[8]||(s[8]=t("div",{class:"mt-9"},[t("h4",{class:"mb-9"},"已預約")],-1)),t("div",E,[t("table",M,[s[3]||(s[3]=t("thead",null,[t("tr",{class:"tr"},[t("th",{width:""}," 預約編號 "),t("th",{width:""},"預約人資料"),t("th",{width:""}," 預約課程 "),t("th",{width:""}," 預約狀態 "),t("th",{width:""}," 訂單詳細 "),t("th",{width:"100"}," 訂單狀態 ")])],-1)),t("tbody",null,[(n(!0),l(m,null,b(r.orderData,e=>(n(),l("tr",{key:e.id,class:"tr"},[t("td",null,d(e.id),1),t("td",null,d(e.user.name),1),t("td",null,[(n(!0),l(m,null,b(e.products,o=>(n(),l("ul",{key:o.id},[t("li",null,d(o.product.title),1)]))),128))]),t("td",null,[t("div",S,[k(t("input",{class:"form-check-input","onUpdate:modelValue":o=>e.is_paid=o,type:"checkbox",role:"switch",id:`paidSwitch${e.id}`,onChange:o=>c.addOrderStates(e)},null,40,B),[[O,e.is_paid]]),t("label",{class:"form-check-label",for:`paidSwitch${e.id}`},d(e.is_paid?"已完課":"未完課"),9,D)])]),s[2]||(s[2]=t("td",null,[t("a",{href:"#"},"看詳細")],-1)),t("td",null,[t("div",L,[s[1]||(s[1]=t("button",{type:"button",class:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#orderModal"}," 編輯 ",-1)),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:o=>c.delOrder(e)}," 刪除 ",8,N)])])]))),128))])]),f(v,{pages:r.pages,onEmitPages:c.getOrders},null,8,["pages","onEmitPages"]),t("div",T,[t("div",U,[t("div",I,[s[6]||(s[6]=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"productModalLabel",class:"modal-title"},[t("span",null,"新增產品"),t("span",null,"編輯產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",R,[t("div",A,[t("div",F,[s[5]||(s[5]=t("div",{class:"mb-3"},[t("label",{for:"imageUrl",class:"form-label"},"主要圖片"),t("input",{id:"imageUrl",type:"text",class:"form-control",placeholder:"請輸入圖片連結"})],-1)),t("div",H,[s[4]||(s[4]=t("label",{for:"file",class:"form-label"},[x("上傳圖片 "),t("i",{class:"fas fa-spinner fa-spin"})],-1)),t("input",{type:"file",class:"form-control mb-4",id:"file",ref:"fileInput",onChange:s[0]||(s[0]=(...e)=>i.uploadPhotos&&i.uploadPhotos(...e))},null,544)])])])]),s[7]||(s[7]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 "),t("button",{type:"button",class:"btn btn-primary"}," 確認 ")],-1))])])])])])],64)}const Y=C(P,[["render",z]]);export{Y as default};
