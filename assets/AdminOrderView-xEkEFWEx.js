import{a as u}from"./axios-G2rPRu76.js";import{S as a}from"./sweetalert2.esm.all-HDkAWA8Y.js";import{_ as y,L as C,r as m,o as n,c as l,b as p,w as x,a as t,F as h,v as b,d as L,u as d,x as S,D as k}from"./index-maz_nPK-.js";import{L as O}from"./LoadingSvg-LMXGMNIf.js";import{P as $}from"./PaginationModal-dR0i2oF1.js";var P={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"rei",BASE_URL:"/2024-roaddriving/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:f,VITE_PATH:g}=P,V={data(){return{orderData:{},pagination:{},pages:{},isloading:!1,isNew:!1}},methods:{getOrders(o=1){this.isloading=!0,u.get(`${f}/api/${g}/admin/orders?page=${o}`).then(s=>{this.orderData=s.data.orders,this.pages=s.data.pagination,this.isloading=!1}).catch(s=>{this.isloading=!1,a.fire({toast:!0,position:"center",showConfirmButton:!1,timer:1500,icon:"error",title:s.response.data.message})})},addOrderStates(o){this.isloading=!0;const s={is_paid:o.is_paid};u.put(`${f}/api/${g}/admin/order/${o.id}`,{data:s}).then(()=>{this.isNew=!1,this.isloading=!1,this.$refs.orderModal.modalClose(),this.getOrders(),a.fire({toast:!0,position:"center",showConfirmButton:!1,timer:1500,icon:"success",title:"編輯成功"})}).catch(()=>{this.isloading=!1,a.fire({toast:!0,position:"center",showConfirmButton:!1,timer:1500,icon:"error",title:"編輯失敗"})})},delOrder(o){this.isNew=!0,this.isloading=!0,u.delete(`${f}/api/${g}/admin/order/${o.id}`).then(()=>{this.isNew=!1,this.isloading=!1,this.getOrders(),a.fire({toast:!0,position:"center",showConfirmButton:!1,timer:1500,icon:"success",title:"刪除成功"})}).catch(s=>{this.isloading=!1,a.fire({toast:!0,position:"center",showConfirmButton:!1,timer:1500,icon:"error",title:s.response.data.message})})}},mounted(){this.getOrders()},components:{PaginationModal:$,Loading:C,LoadingSvg:O}},E={class:"container px-6"},M={class:"admin-table"},B={class:"table mt-4 table-bordered"},D={class:"form-check form-switch"},N=["onUpdate:modelValue","id","onChange"],T=["for"],U={class:"btn-group"},I=["onClick"],R={class:"modal fade",id:"orderModal",tabindex:"-1","aria-labelledby":"orderModal","aria-hidden":"true"},A={class:"modal-dialog modal-xl"},F={class:"modal-content border-0"},H={class:"modal-body"},z={class:"row"},j={class:"col-3"},q={class:"mb-3"};function G(o,s,J,K,r,c){const _=m("LoadingSvg"),v=m("Loading"),w=m("PaginationModal");return n(),l(h,null,[p(v,{active:r.isloading,"z-index":1060},{default:x(()=>[p(_)]),_:1},8,["active"]),t("div",E,[s[8]||(s[8]=t("div",{class:"mt-9"},[t("h4",{class:"mb-9"},"已預約")],-1)),t("div",M,[t("table",B,[s[3]||(s[3]=t("thead",null,[t("tr",{class:"tr"},[t("th",{width:""}," 預約編號 "),t("th",{width:""},"預約人資料"),t("th",{width:""}," 預約課程 "),t("th",{width:""}," 預約狀態 "),t("th",{width:""}," 訂單詳細 "),t("th",{width:"100"}," 訂單狀態 ")])],-1)),t("tbody",null,[(n(!0),l(h,null,b(r.orderData,e=>(n(),l("tr",{key:e.id,class:"tr"},[t("td",null,d(e.id),1),t("td",null,d(e.user.name),1),t("td",null,[(n(!0),l(h,null,b(e.products,i=>(n(),l("ul",{key:i.id},[t("li",null,d(i.product.title),1)]))),128))]),t("td",null,[t("div",D,[S(t("input",{class:"form-check-input","onUpdate:modelValue":i=>e.is_paid=i,type:"checkbox",role:"switch",id:`paidSwitch${e.id}`,onChange:i=>c.addOrderStates(e)},null,40,N),[[k,e.is_paid]]),t("label",{class:"form-check-label",for:`paidSwitch${e.id}`},d(e.is_paid?"已完課":"未完課"),9,T)])]),s[2]||(s[2]=t("td",null,[t("a",{href:"#"},"看詳細")],-1)),t("td",null,[t("div",U,[s[1]||(s[1]=t("button",{type:"button",class:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#orderModal"}," 編輯 ",-1)),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:i=>c.delOrder(e)}," 刪除 ",8,I)])])]))),128))])]),p(w,{pages:r.pages,onEmitPages:c.getOrders},null,8,["pages","onEmitPages"]),t("div",R,[t("div",A,[t("div",F,[s[6]||(s[6]=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"productModalLabel",class:"modal-title"},[t("span",null,"新增產品"),t("span",null,"編輯產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",H,[t("div",z,[t("div",j,[s[5]||(s[5]=t("div",{class:"mb-3"},[t("label",{for:"imageUrl",class:"form-label"},"主要圖片"),t("input",{id:"imageUrl",type:"text",class:"form-control",placeholder:"請輸入圖片連結"})],-1)),t("div",q,[s[4]||(s[4]=t("label",{for:"file",class:"form-label"},[L("上傳圖片 "),t("i",{class:"fas fa-spinner fa-spin"})],-1)),t("input",{type:"file",class:"form-control mb-4",id:"file",ref:"fileInput",onChange:s[0]||(s[0]=(...e)=>o.uploadPhotos&&o.uploadPhotos(...e))},null,544)])])])]),s[7]||(s[7]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 "),t("button",{type:"button",class:"btn btn-primary"}," 確認 ")],-1))])])])])])],64)}const tt=y(V,[["render",G]]);export{tt as default};
